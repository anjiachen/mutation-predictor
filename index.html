<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>蛋白质突变预测系统</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 3em;
            font-weight: 300;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        /* 上传界面样式 */
        #upload-interface {
            display: block;
        }

        .upload-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            text-align: center;
        }

        .upload-area {
            border: 3px dashed #4facfe;
            border-radius: 15px;
            padding: 40px 20px;
            margin-bottom: 30px;
            background: #f8f9fa;
            transition: all 0.3s;
            cursor: pointer;
        }

        .upload-area:hover {
            background: #e3f2fd;
            border-color: #1976d2;
        }

        .upload-area.dragover {
            background: #e3f2fd;
            border-color: #1976d2;
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 48px;
            color: #4facfe;
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 18px;
            color: #666;
            margin-bottom: 10px;
        }

        .upload-subtitle {
            font-size: 14px;
            color: #999;
            margin-bottom: 20px;
        }

        .file-input {
            display: none;
        }

        .file-info {
            background: #e8f5e8;
            border: 2px solid #56ab2f;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            display: none;
        }

        .file-info.show {
            display: block;
        }

        .file-name {
            font-weight: bold;
            color: #56ab2f;
            margin-bottom: 5px;
        }

        .file-details {
            font-size: 14px;
            color: #666;
        }

        .run-model-btn {
            width: 100%;
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            color: white;
            padding: 18px;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 20px;
            opacity: 0.5;
            pointer-events: none;
        }

        .run-model-btn.active {
            opacity: 1;
            pointer-events: auto;
        }

        .run-model-btn.active:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(86, 171, 47, 0.3);
        }

        .error-message {
            background: #ffe8e8;
            border: 2px solid #ff6b6b;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            color: #d63031;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .loading-spinner {
            display: none;
            margin: 20px 0;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4facfe;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .requirements {
            background: #fff3cd;
            border: 2px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            font-size: 14px;
            color: #856404;
        }

        .requirements h3 {
            margin-bottom: 10px;
            color: #856404;
        }

        .requirements ul {
            margin-left: 20px;
        }

        .requirements li {
            margin-bottom: 5px;
        }

        /* 预测系统界面样式（隐藏） */
        #prediction-interface {
            display: none;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .card h2 {
            color: #333;
            margin-bottom: 25px;
            font-size: 1.8em;
            font-weight: 500;
        }

        .position-section {
            margin-bottom: 30px;
        }

        .position-input {
            position: relative;
            margin-bottom: 20px;
        }

        .position-input label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #555;
        }

        .position-input input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
            background: #f8f9fa;
        }

        .position-input input:focus {
            outline: none;
            border-color: #4facfe;
            background: white;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .position-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
        }

        .position-tag {
            background: #e3f2fd;
            color: #1976d2;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid #bbdefb;
        }

        .position-tag:hover {
            background: #1976d2;
            color: white;
        }

        .amino-acids-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
            gap: 10px;
            margin-bottom: 25px;
        }

        .amino-acid {
            aspect-ratio: 1;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            background: #f8f9fa;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .amino-acid:hover {
            border-color: #4facfe;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            background: white;
        }

        .amino-acid.selected {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-color: #4facfe;
            color: white;
            transform: scale(1.05);
        }

        .amino-acid .letter {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 4px;
        }

        .amino-acid .name {
            font-size: 10px;
            text-align: center;
            line-height: 1.2;
            opacity: 0.8;
        }

        .predict-btn {
            width: 100%;
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            color: white;
            padding: 18px;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .predict-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(86, 171, 47, 0.3);
        }

        .predict-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .stats-btn {
            width: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 18px;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stats-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .results-card {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: none;
            position: relative;
            overflow: hidden;
        }

        .results-card.show {
            display: block;
            animation: slideUp 0.5s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .results-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .results-header h3 {
            font-size: 2.2em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .mutation-info {
            background: rgba(255,255,255,0.1);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .info-item {
            text-align: center;
        }

        .info-item .label {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .info-item .value {
            font-size: 18px;
            font-weight: 600;
        }

        .probability-section {
            margin: 30px 0;
        }

        .probability-bars {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 25px 0;
        }

        .probability-bar h4 {
            margin-bottom: 15px;
            font-size: 1.3em;
            text-align: center;
        }

        .bar-container {
            background: rgba(255,255,255,0.2);
            height: 50px;
            border-radius: 25px;
            overflow: hidden;
            position: relative;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .bar-fill {
            height: 100%;
            border-radius: 25px;
            transition: width 1s ease-out;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
            position: relative;
        }

        .bar-fill.harmful {
            background: linear-gradient(90deg, #ff6b6b, #ee5a24);
        }

        .bar-fill.benign {
            background: linear-gradient(90deg, #20bf6b, #0fb9b1);
        }

        .risk-assessment {
            background: rgba(255,255,255,0.1);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .risk-assessment h4 {
            font-size: 1.4em;
            margin-bottom: 15px;
        }

        .risk-text {
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .rank-info {
            font-size: 18px;
            font-weight: 600;
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .data-info {
            text-align: center;
            color: white;
            margin-top: 30px;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .amino-acids-grid {
                grid-template-columns: repeat(5, 1fr);
            }
        }

        /* 热图样式 */
        .heatmap-card {
            grid-column: 1 / -1;
            margin-top: 30px;
        }

        .heatmap-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .heatmap-header h3 {
            font-size: 2em;
            margin-bottom: 10px;
            color: #333;
        }

        .heatmap-header p {
            color: #666;
            font-size: 1.1em;
        }

        .heatmap-legend {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 25px;
            gap: 15px;
        }

        .legend-gradient {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .legend-bar {
            width: 200px;
            height: 20px;
            background: linear-gradient(to right, #fff3cd 0%, #dc3545 100%);
            border: 1px solid #ddd;
            border-radius: 10px;
        }

        .legend-label {
            font-size: 14px;
            color: #666;
        }

        .heatmap-table {
            display: grid;
            gap: 2px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 15px;
            margin: 0 auto;
            max-width: 100%;
            overflow-x: auto;
        }

        .heatmap-row {
            display: grid;
            grid-template-columns: 80px repeat(9, 1fr);
            gap: 2px;
            align-items: center;
        }

        .heatmap-cell {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 8px;
            text-align: center;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s;
            position: relative;
            min-height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .heatmap-cell.header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
            font-size: 13px;
        }

        .heatmap-cell.row-header {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            color: white;
            font-weight: 600;
            font-size: 14px;
        }

        .heatmap-cell.top5 {
            background: linear-gradient(135deg, #ff6b6b 0%, #ffd93d 100%);
            color: #333;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(255, 107, 107, 0.3);
            transform: scale(1.02);
        }

        .heatmap-cell.blue-highlight .aa-letter {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .heatmap-cell.top5.blue-highlight .aa-letter {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .heatmap-cell.empty {
            background: #f8f9fa;
            color: #ccc;
        }

        .heatmap-cell:hover:not(.header):not(.row-header):not(.empty) {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 10;
        }

        .value-display {
            font-size: 11px;
            line-height: 1.2;
        }

        .aa-letter {
            font-weight: bold;
            margin-bottom: 2px;
        }

        .binding-value {
            color: #666;
        }

        @media (max-width: 768px) {
            .heatmap-table {
                font-size: 10px;
                padding: 10px;
            }
            
            .heatmap-cell {
                padding: 6px 2px;
                font-size: 10px;
                min-height: 30px;
            }
            
            .legend-bar {
                width: 150px;
                height: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧬 蛋白质突变预测系统</h1>
            <p>基于深度学习模型的高精度突变效应预测平台</p>
        </div>

        <!-- 上传数据界面 -->
        <div id="upload-interface">
            <div class="upload-container">
                <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                    <div class="upload-icon">📁</div>
                    <div class="upload-text">点击选择文件或拖拽文件至此处</div>
                    <div class="upload-subtitle">请上传训练数据文件（支持Excel格式）</div>
                </div>

                <input type="file" id="fileInput" class="file-input" accept=".xlsx,.xls">

                <div id="fileInfo" class="file-info">
                    <div class="file-name" id="fileName"></div>
                    <div class="file-details" id="fileDetails"></div>
                </div>

                <div id="errorMessage" class="error-message">
                    <div id="errorText"></div>
                </div>

                <div id="loadingSpinner" class="loading-spinner">
                    <div class="spinner"></div>
                    <p>正在运行模型...</p>
                </div>

                <button id="runModelBtn" class="run-model-btn">
                    🚀 运行突变预测模型
                </button>
            </div>
        </div>

        <!-- 预测系统界面（初始隐藏） -->
        <div id="prediction-interface">
            <div class="main-grid">
            <div class="card">
                <h2>📍 选择突变位置</h2>
                <div class="position-section">
                    <div class="position-input">
                        <label for="position">突变位置 (范围: 302-417):</label>
                        <input type="number" id="position" placeholder="例如: 384" min="302" max="417">
                    </div>
                    <div class="position-suggestions" id="position-suggestions">
                        <div class="position-tag" onclick="selectPosition(384)">384</div>
                        <div class="position-tag" onclick="selectPosition(348)">348</div>
                        <div class="position-tag" onclick="selectPosition(417)">417</div>
                        <div class="position-tag" onclick="selectPosition(309)">309</div>
                        <div class="position-tag" onclick="selectPosition(346)">346</div>
                        <div class="position-tag" onclick="selectPosition(302)">302</div>
                        <div class="position-tag" onclick="selectPosition(305)">305</div>
                        <div class="position-tag" onclick="selectPosition(306)">306</div>
                        <div class="position-tag" onclick="selectPosition(401)">401</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>🧪 选择目标氨基酸</h2>
                <div class="amino-acids-grid">
                    <div class="amino-acid" data-aa="A">
                        <div class="letter">A</div>
                        <div class="name">丙氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="R">
                        <div class="letter">R</div>
                        <div class="name">精氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="N">
                        <div class="letter">N</div>
                        <div class="name">天冬酰胺</div>
                    </div>
                    <div class="amino-acid" data-aa="D">
                        <div class="letter">D</div>
                        <div class="name">天冬氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="C">
                        <div class="letter">C</div>
                        <div class="name">半胱氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="Q">
                        <div class="letter">Q</div>
                        <div class="name">谷氨酰胺</div>
                    </div>
                    <div class="amino-acid" data-aa="E">
                        <div class="letter">E</div>
                        <div class="name">谷氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="G">
                        <div class="letter">G</div>
                        <div class="name">甘氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="H">
                        <div class="letter">H</div>
                        <div class="name">组氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="I">
                        <div class="letter">I</div>
                        <div class="name">异亮氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="L">
                        <div class="letter">L</div>
                        <div class="name">亮氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="K">
                        <div class="letter">K</div>
                        <div class="name">赖氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="M">
                        <div class="letter">M</div>
                        <div class="name">蛋氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="F">
                        <div class="letter">F</div>
                        <div class="name">苯丙氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="P">
                        <div class="letter">P</div>
                        <div class="name">脯氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="S">
                        <div class="letter">S</div>
                        <div class="name">丝氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="T">
                        <div class="letter">T</div>
                        <div class="name">苏氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="W">
                        <div class="letter">W</div>
                        <div class="name">色氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="Y">
                        <div class="letter">Y</div>
                        <div class="name">酪氨酸</div>
                    </div>
                    <div class="amino-acid" data-aa="V">
                        <div class="letter">V</div>
                        <div class="name">缬氨酸</div>
                    </div>
                </div>
                <button class="predict-btn" onclick="predictMutation()">🔬 预测突变效应</button>
                <button class="stats-btn" onclick="showHeatmap()">📈 数据统计热图</button>
            </div>
        </div>

        <div class="card results-card" id="results">
            <div class="results-header">
                <h3>📊 预测结果分析</h3>
                <p>基于深度学习模型的突变效应评估</p>
            </div>

            <div class="mutation-info">
                <div class="info-grid">
                    <div class="info-item">
                        <div class="label">突变标识</div>
                        <div class="value" id="mutation-id">-</div>
                    </div>
                    <div class="info-item">
                        <div class="label">原始氨基酸</div>
                        <div class="value" id="original-aa">-</div>
                    </div>
                    <div class="info-item">
                        <div class="label">目标氨基酸</div>
                        <div class="value" id="target-aa">-</div>
                    </div>
                    <div class="info-item">
                        <div class="label">突变位置</div>
                        <div class="value">第 <span id="mutation-position">-</span> 位</div>
                    </div>
                </div>
            </div>

                         <div class="probability-section">
                 <div class="probability-bars">
                     <div class="probability-bar" style="grid-column: 1 / -1;">
                         <h4>🧬 TCOY结合强度</h4>
                         <div class="bar-container">
                             <div class="bar-fill benign" id="benign-bar">0%</div>
                         </div>
                     </div>
                 </div>
             </div>

                         <div class="risk-assessment">
                 <h4>💡 结合强度评估</h4>
                 <div class="risk-text" id="risk-text"></div>
                 <div class="rank-info">
                     <span>结合强度排名: 第 <span id="rank">-</span> 位</span>
                     <span style="margin-left: 20px;">（共 171 个突变）</span>
                 </div>
             </div>

                         <div class="summary-stats">
                 <div class="stat-card">
                     <div class="stat-number" id="percentile">-</div>
                     <div class="stat-label">结合强度百分位</div>
                 </div>
                 <div class="stat-card">
                     <div class="stat-number" id="confidence">高</div>
                     <div class="stat-label">预测置信度</div>
                 </div>
             </div>
        </div>

        <!-- 热图统计区域 -->
        <div class="card heatmap-card" id="heatmap-container" style="display: none;">
            <div class="heatmap-header">
                <h3>📊 蛋白质突变TCOY结合强度热图统计</h3>
                <p>显示各位点Top5氨基酸的结合强度分布</p>
            </div>
            <div class="heatmap-content">
                <div class="heatmap-legend">
                    <span>TCOY结合强度：</span>
                    <div class="legend-gradient">
                        <span class="legend-label">低 (0%)</span>
                        <div class="legend-bar"></div>
                        <span class="legend-label">高 (30%)</span>
                    </div>
                </div>
                <div class="heatmap-table" id="heatmap-table">
                    <!-- 热图表格将在此动态生成 -->
                </div>
            </div>
        </div>

        <div class="data-info">
            <h3>📋 系统信息</h3>
            <p>本系统展示了基于机器学习模型对 171 个蛋白质突变的预测结果，涵盖位置 302-417 区域的所有可能氨基酸替换。</p>
            <p>该模型结合了结构建模与大量实验数据训练，专门针对特定底物（TCOY）的识别能力进行预测，为酶工程改造提供指导。</p>
        </div>
        </div> <!-- 关闭 prediction-interface div -->
    </div>

    <script>
        // 完整的突变数据库 - 从CSV文件加载的171个突变记录
        const mutationData = {
            "384A": {
                        "benign": 0.9422,
                        "harmful": 0.0578,
                        "rank": 341,
                        "position": "384",
                        "amino_acid": "A",
                        "original": "K"
            },
            "384C": {
                        "benign": 0.9371,
                        "harmful": 0.0629,
                        "rank": 332,
                        "position": "384",
                        "amino_acid": "C",
                        "original": "K"
            },
            "384E": {
                        "benign": 0.8961,
                        "harmful": 0.1039,
                        "rank": 279,
                        "position": "384",
                        "amino_acid": "E",
                        "original": "K"
            },
            "384D": {
                        "benign": 0.9383,
                        "harmful": 0.0617,
                        "rank": 335,
                        "position": "384",
                        "amino_acid": "D",
                        "original": "K"
            },
            "384G": {
                        "benign": 0.939,
                        "harmful": 0.061,
                        "rank": 339,
                        "position": "384",
                        "amino_acid": "G",
                        "original": "K"
            },
            "384I": {
                        "benign": 0.9358,
                        "harmful": 0.0642,
                        "rank": 324,
                        "position": "384",
                        "amino_acid": "I",
                        "original": "K"
            },
            "384H": {
                        "benign": 0.878,
                        "harmful": 0.122,
                        "rank": 253,
                        "position": "384",
                        "amino_acid": "H",
                        "original": "K"
            },
            "384K": {
                        "benign": 0.9293,
                        "harmful": 0.0707,
                        "rank": 313,
                        "position": "384",
                        "amino_acid": "K",
                        "original": "K"
            },
            "384M": {
                        "benign": 0.9454,
                        "harmful": 0.0546,
                        "rank": 342,
                        "position": "384",
                        "amino_acid": "M",
                        "original": "K"
            },
            "384L": {
                        "benign": 0.9083,
                        "harmful": 0.0917,
                        "rank": 287,
                        "position": "384",
                        "amino_acid": "L",
                        "original": "K"
            },
            "384N": {
                        "benign": 0.914,
                        "harmful": 0.086,
                        "rank": 295,
                        "position": "384",
                        "amino_acid": "N",
                        "original": "K"
            },
            "384Q": {
                        "benign": 0.9352,
                        "harmful": 0.0648,
                        "rank": 323,
                        "position": "384",
                        "amino_acid": "Q",
                        "original": "K"
            },
            "384P": {
                        "benign": 0.8989,
                        "harmful": 0.1011,
                        "rank": 284,
                        "position": "384",
                        "amino_acid": "P",
                        "original": "K"
            },
            "384S": {
                        "benign": 0.9363,
                        "harmful": 0.0637,
                        "rank": 328,
                        "position": "384",
                        "amino_acid": "S",
                        "original": "K"
            },
            "384R": {
                        "benign": 0.9388,
                        "harmful": 0.0612,
                        "rank": 337,
                        "position": "384",
                        "amino_acid": "R",
                        "original": "K"
            },
            "384T": {
                        "benign": 0.9364,
                        "harmful": 0.0636,
                        "rank": 329,
                        "position": "384",
                        "amino_acid": "T",
                        "original": "K"
            },
            "384W": {
                        "benign": 0.8798,
                        "harmful": 0.1202,
                        "rank": 259,
                        "position": "384",
                        "amino_acid": "W",
                        "original": "K"
            },
            "384V": {
                        "benign": 0.9283,
                        "harmful": 0.0717,
                        "rank": 310,
                        "position": "384",
                        "amino_acid": "V",
                        "original": "K"
            },
            "384Y": {
                        "benign": 0.9335,
                        "harmful": 0.0665,
                        "rank": 319,
                        "position": "384",
                        "amino_acid": "Y",
                        "original": "K"
            },
            "348Y": {
                        "benign": 0.8003,
                        "harmful": 0.1997,
                        "rank": 80,
                        "position": "348",
                        "amino_acid": "Y",
                        "original": "K"
            },
            "348Q": {
                        "benign": 0.7934,
                        "harmful": 0.2066,
                        "rank": 50,
                        "position": "348",
                        "amino_acid": "Q",
                        "original": "K"
            },
            "348P": {
                        "benign": 0.8287,
                        "harmful": 0.1713,
                        "rank": 191,
                        "position": "348",
                        "amino_acid": "P",
                        "original": "K"
            },
            "348S": {
                        "benign": 0.779,
                        "harmful": 0.221,
                        "rank": 23,
                        "position": "348",
                        "amino_acid": "S",
                        "original": "K"
            },
            "348R": {
                        "benign": 0.7928,
                        "harmful": 0.2072,
                        "rank": 47,
                        "position": "348",
                        "amino_acid": "R",
                        "original": "K"
            },
            "348T": {
                        "benign": 0.7959,
                        "harmful": 0.2041,
                        "rank": 60,
                        "position": "348",
                        "amino_acid": "T",
                        "original": "K"
            },
            "348W": {
                        "benign": 0.8081,
                        "harmful": 0.1919,
                        "rank": 109,
                        "position": "348",
                        "amino_acid": "W",
                        "original": "K"
            },
            "348V": {
                        "benign": 0.8146,
                        "harmful": 0.1854,
                        "rank": 138,
                        "position": "348",
                        "amino_acid": "V",
                        "original": "K"
            },
            "348I": {
                        "benign": 0.8118,
                        "harmful": 0.1882,
                        "rank": 131,
                        "position": "348",
                        "amino_acid": "I",
                        "original": "K"
            },
            "348H": {
                        "benign": 0.8308,
                        "harmful": 0.1692,
                        "rank": 203,
                        "position": "348",
                        "amino_acid": "H",
                        "original": "K"
            },
            "348K": {
                        "benign": 0.7517,
                        "harmful": 0.2483,
                        "rank": 4,
                        "position": "348",
                        "amino_acid": "K",
                        "original": "K"
            },
            "348M": {
                        "benign": 0.8103,
                        "harmful": 0.1897,
                        "rank": 118,
                        "position": "348",
                        "amino_acid": "M",
                        "original": "K"
            },
            "348L": {
                        "benign": 0.8425,
                        "harmful": 0.1575,
                        "rank": 226,
                        "position": "348",
                        "amino_acid": "L",
                        "original": "K"
            },
            "348N": {
                        "benign": 0.8051,
                        "harmful": 0.1949,
                        "rank": 92,
                        "position": "348",
                        "amino_acid": "N",
                        "original": "K"
            },
            "348A": {
                        "benign": 0.7851,
                        "harmful": 0.2149,
                        "rank": 33,
                        "position": "348",
                        "amino_acid": "A",
                        "original": "K"
            },
            "348C": {
                        "benign": 0.7703,
                        "harmful": 0.2297,
                        "rank": 13,
                        "position": "348",
                        "amino_acid": "C",
                        "original": "K"
            },
            "348E": {
                        "benign": 0.7842,
                        "harmful": 0.2158,
                        "rank": 31,
                        "position": "348",
                        "amino_acid": "E",
                        "original": "K"
            },
            "348D": {
                        "benign": 0.7983,
                        "harmful": 0.2017,
                        "rank": 72,
                        "position": "348",
                        "amino_acid": "D",
                        "original": "K"
            },
            "348F": {
                        "benign": 0.806,
                        "harmful": 0.194,
                        "rank": 97,
                        "position": "348",
                        "amino_acid": "F",
                        "original": "K"
            },
            "417G": {
                        "benign": 0.9092,
                        "harmful": 0.0908,
                        "rank": 288,
                        "position": "417",
                        "amino_acid": "G",
                        "original": "K"
            },
            "346W": {
                        "benign": 0.7745,
                        "harmful": 0.2255,
                        "rank": 16,
                        "position": "346",
                        "amino_acid": "W",
                        "original": "K"
            },
            "309C": {
                        "benign": 0.7812,
                        "harmful": 0.2188,
                        "rank": 26,
                        "position": "309",
                        "amino_acid": "C",
                        "original": "K"
            },
            "309A": {
                        "benign": 0.7972,
                        "harmful": 0.2028,
                        "rank": 69,
                        "position": "309",
                        "amino_acid": "A",
                        "original": "K"
            },
            "309F": {
                        "benign": 0.7997,
                        "harmful": 0.2003,
                        "rank": 76,
                        "position": "309",
                        "amino_acid": "F",
                        "original": "K"
            },
            "309G": {
                        "benign": 0.8113,
                        "harmful": 0.1887,
                        "rank": 128,
                        "position": "309",
                        "amino_acid": "G",
                        "original": "K"
            },
            "309D": {
                        "benign": 0.7976,
                        "harmful": 0.2024,
                        "rank": 71,
                        "position": "309",
                        "amino_acid": "D",
                        "original": "K"
            },
            "309E": {
                        "benign": 0.847,
                        "harmful": 0.153,
                        "rank": 233,
                        "position": "309",
                        "amino_acid": "E",
                        "original": "K"
            },
            "309K": {
                        "benign": 0.8257,
                        "harmful": 0.1743,
                        "rank": 178,
                        "position": "309",
                        "amino_acid": "K",
                        "original": "K"
            },
            "309H": {
                        "benign": 0.8154,
                        "harmful": 0.1846,
                        "rank": 142,
                        "position": "309",
                        "amino_acid": "H",
                        "original": "K"
            },
            "309I": {
                        "benign": 0.8166,
                        "harmful": 0.1834,
                        "rank": 148,
                        "position": "309",
                        "amino_acid": "I",
                        "original": "K"
            },
            "309N": {
                        "benign": 0.8069,
                        "harmful": 0.1931,
                        "rank": 101,
                        "position": "309",
                        "amino_acid": "N",
                        "original": "K"
            },
            "309L": {
                        "benign": 0.8167,
                        "harmful": 0.1833,
                        "rank": 150,
                        "position": "309",
                        "amino_acid": "L",
                        "original": "K"
            },
            "309R": {
                        "benign": 0.7888,
                        "harmful": 0.2112,
                        "rank": 40,
                        "position": "309",
                        "amino_acid": "R",
                        "original": "K"
            },
            "309S": {
                        "benign": 0.8003,
                        "harmful": 0.1997,
                        "rank": 79,
                        "position": "309",
                        "amino_acid": "S",
                        "original": "K"
            },
            "309P": {
                        "benign": 0.7962,
                        "harmful": 0.2038,
                        "rank": 61,
                        "position": "309",
                        "amino_acid": "P",
                        "original": "K"
            },
            "309Q": {
                        "benign": 0.8324,
                        "harmful": 0.1676,
                        "rank": 209,
                        "position": "309",
                        "amino_acid": "Q",
                        "original": "K"
            },
            "309V": {
                        "benign": 0.7739,
                        "harmful": 0.2261,
                        "rank": 15,
                        "position": "309",
                        "amino_acid": "V",
                        "original": "K"
            },
            "309W": {
                        "benign": 0.7525,
                        "harmful": 0.2475,
                        "rank": 5,
                        "position": "309",
                        "amino_acid": "W",
                        "original": "K"
            },
            "309T": {
                        "benign": 0.7843,
                        "harmful": 0.2157,
                        "rank": 32,
                        "position": "309",
                        "amino_acid": "T",
                        "original": "K"
            },
            "417M": {
                        "benign": 0.862,
                        "harmful": 0.138,
                        "rank": 238,
                        "position": "417",
                        "amino_acid": "M",
                        "original": "K"
            },
            "346N": {
                        "benign": 0.7879,
                        "harmful": 0.2121,
                        "rank": 38,
                        "position": "346",
                        "amino_acid": "N",
                        "original": "K"
            },
            "346M": {
                        "benign": 0.8207,
                        "harmful": 0.1793,
                        "rank": 161,
                        "position": "346",
                        "amino_acid": "M",
                        "original": "K"
            },
            "309Y": {
                        "benign": 0.8073,
                        "harmful": 0.1927,
                        "rank": 106,
                        "position": "309",
                        "amino_acid": "Y",
                        "original": "K"
            },
            "346K": {
                        "benign": 0.7619,
                        "harmful": 0.2381,
                        "rank": 9,
                        "position": "346",
                        "amino_acid": "K",
                        "original": "K"
            },
            "346I": {
                        "benign": 0.801,
                        "harmful": 0.199,
                        "rank": 82,
                        "position": "346",
                        "amino_acid": "I",
                        "original": "K"
            },
            "346H": {
                        "benign": 0.7987,
                        "harmful": 0.2013,
                        "rank": 75,
                        "position": "346",
                        "amino_acid": "H",
                        "original": "K"
            },
            "346L": {
                        "benign": 0.7933,
                        "harmful": 0.2067,
                        "rank": 49,
                        "position": "346",
                        "amino_acid": "L",
                        "original": "K"
            },
            "417K": {
                        "benign": 0.8831,
                        "harmful": 0.1169,
                        "rank": 264,
                        "position": "417",
                        "amino_acid": "K",
                        "original": "K"
            },
            "302Y": {
                        "benign": 0.7721,
                        "harmful": 0.2279,
                        "rank": 14,
                        "position": "302",
                        "amino_acid": "Y",
                        "original": "K"
            },
            "302W": {
                        "benign": 0.8134,
                        "harmful": 0.1866,
                        "rank": 135,
                        "position": "302",
                        "amino_acid": "W",
                        "original": "K"
            },
            "302V": {
                        "benign": 0.7755,
                        "harmful": 0.2245,
                        "rank": 19,
                        "position": "302",
                        "amino_acid": "V",
                        "original": "K"
            },
            "302T": {
                        "benign": 0.806,
                        "harmful": 0.194,
                        "rank": 96,
                        "position": "302",
                        "amino_acid": "T",
                        "original": "K"
            },
            "302S": {
                        "benign": 0.826,
                        "harmful": 0.174,
                        "rank": 179,
                        "position": "302",
                        "amino_acid": "S",
                        "original": "K"
            },
            "302R": {
                        "benign": 0.8183,
                        "harmful": 0.1817,
                        "rank": 155,
                        "position": "302",
                        "amino_acid": "R",
                        "original": "K"
            },
            "302Q": {
                        "benign": 0.8306,
                        "harmful": 0.1694,
                        "rank": 202,
                        "position": "302",
                        "amino_acid": "Q",
                        "original": "K"
            },
            "302P": {
                        "benign": 0.8028,
                        "harmful": 0.1972,
                        "rank": 85,
                        "position": "302",
                        "amino_acid": "P",
                        "original": "K"
            },
            "302N": {
                        "benign": 0.8291,
                        "harmful": 0.1709,
                        "rank": 195,
                        "position": "302",
                        "amino_acid": "N",
                        "original": "K"
            },
            "302M": {
                        "benign": 0.8311,
                        "harmful": 0.1689,
                        "rank": 204,
                        "position": "302",
                        "amino_acid": "M",
                        "original": "K"
            },
            "302L": {
                        "benign": 0.8285,
                        "harmful": 0.1715,
                        "rank": 189,
                        "position": "302",
                        "amino_acid": "L",
                        "original": "K"
            },
            "302K": {
                        "benign": 0.8067,
                        "harmful": 0.1933,
                        "rank": 99,
                        "position": "302",
                        "amino_acid": "K",
                        "original": "K"
            },
            "302I": {
                        "benign": 0.808,
                        "harmful": 0.192,
                        "rank": 108,
                        "position": "302",
                        "amino_acid": "I",
                        "original": "K"
            },
            "302H": {
                        "benign": 0.8151,
                        "harmful": 0.1849,
                        "rank": 140,
                        "position": "302",
                        "amino_acid": "H",
                        "original": "K"
            },
            "302G": {
                        "benign": 0.7928,
                        "harmful": 0.2072,
                        "rank": 48,
                        "position": "302",
                        "amino_acid": "G",
                        "original": "K"
            },
            "302F": {
                        "benign": 0.7856,
                        "harmful": 0.2144,
                        "rank": 35,
                        "position": "302",
                        "amino_acid": "F",
                        "original": "K"
            },
            "302E": {
                        "benign": 0.8097,
                        "harmful": 0.1903,
                        "rank": 115,
                        "position": "302",
                        "amino_acid": "E",
                        "original": "K"
            },
            "302D": {
                        "benign": 0.8096,
                        "harmful": 0.1904,
                        "rank": 113,
                        "position": "302",
                        "amino_acid": "D",
                        "original": "K"
            },
            "302C": {
                        "benign": 0.8073,
                        "harmful": 0.1927,
                        "rank": 104,
                        "position": "302",
                        "amino_acid": "C",
                        "original": "K"
            },
            "417T": {
                        "benign": 0.8427,
                        "harmful": 0.1573,
                        "rank": 227,
                        "position": "417",
                        "amino_acid": "T",
                        "original": "K"
            },
            "417V": {
                        "benign": 0.8765,
                        "harmful": 0.1235,
                        "rank": 249,
                        "position": "417",
                        "amino_acid": "V",
                        "original": "K"
            },
            "417P": {
                        "benign": 0.8763,
                        "harmful": 0.1237,
                        "rank": 248,
                        "position": "417",
                        "amino_acid": "P",
                        "original": "K"
            },
            "417Q": {
                        "benign": 0.8784,
                        "harmful": 0.1216,
                        "rank": 255,
                        "position": "417",
                        "amino_acid": "Q",
                        "original": "K"
            },
            "417R": {
                        "benign": 0.8847,
                        "harmful": 0.1153,
                        "rank": 266,
                        "position": "417",
                        "amino_acid": "R",
                        "original": "K"
            },
            "346V": {
                        "benign": 0.8036,
                        "harmful": 0.1964,
                        "rank": 88,
                        "position": "346",
                        "amino_acid": "V",
                        "original": "K"
            },
            "417Y": {
                        "benign": 0.9063,
                        "harmful": 0.0937,
                        "rank": 286,
                        "position": "417",
                        "amino_acid": "Y",
                        "original": "K"
            },
            "417D": {
                        "benign": 0.8782,
                        "harmful": 0.1218,
                        "rank": 254,
                        "position": "417",
                        "amino_acid": "D",
                        "original": "K"
            },
            "417E": {
                        "benign": 0.912,
                        "harmful": 0.088,
                        "rank": 293,
                        "position": "417",
                        "amino_acid": "E",
                        "original": "K"
            },
            "417F": {
                        "benign": 0.8907,
                        "harmful": 0.1093,
                        "rank": 275,
                        "position": "417",
                        "amino_acid": "F",
                        "original": "K"
            },
            "346T": {
                        "benign": 0.802,
                        "harmful": 0.198,
                        "rank": 84,
                        "position": "346",
                        "amino_acid": "T",
                        "original": "K"
            },
            "417A": {
                        "benign": 0.8054,
                        "harmful": 0.1946,
                        "rank": 94,
                        "position": "417",
                        "amino_acid": "A",
                        "original": "K"
            },
            "417C": {
                        "benign": 0.8239,
                        "harmful": 0.1761,
                        "rank": 172,
                        "position": "417",
                        "amino_acid": "C",
                        "original": "K"
            },
            "417L": {
                        "benign": 0.8643,
                        "harmful": 0.1357,
                        "rank": 239,
                        "position": "417",
                        "amino_acid": "L",
                        "original": "K"
            },
            "346S": {
                        "benign": 0.7952,
                        "harmful": 0.2048,
                        "rank": 58,
                        "position": "346",
                        "amino_acid": "S",
                        "original": "K"
            },
            "417N": {
                        "benign": 0.879,
                        "harmful": 0.121,
                        "rank": 256,
                        "position": "417",
                        "amino_acid": "N",
                        "original": "K"
            },
            "417H": {
                        "benign": 0.9346,
                        "harmful": 0.0654,
                        "rank": 322,
                        "position": "417",
                        "amino_acid": "H",
                        "original": "K"
            },
            "417I": {
                        "benign": 0.8974,
                        "harmful": 0.1026,
                        "rank": 282,
                        "position": "417",
                        "amino_acid": "I",
                        "original": "K"
            },
            "346R": {
                        "benign": 0.7852,
                        "harmful": 0.2148,
                        "rank": 34,
                        "position": "346",
                        "amino_acid": "R",
                        "original": "K"
            },
            "346Q": {
                        "benign": 0.7941,
                        "harmful": 0.2059,
                        "rank": 54,
                        "position": "346",
                        "amino_acid": "Q",
                        "original": "K"
            },
            "346P": {
                        "benign": 0.827,
                        "harmful": 0.173,
                        "rank": 182,
                        "position": "346",
                        "amino_acid": "P",
                        "original": "K"
            },
            "346Y": {
                        "benign": 0.7881,
                        "harmful": 0.2119,
                        "rank": 39,
                        "position": "346",
                        "amino_acid": "Y",
                        "original": "K"
            },
            "417S": {
                        "benign": 0.7788,
                        "harmful": 0.2212,
                        "rank": 22,
                        "position": "417",
                        "amino_acid": "S",
                        "original": "K"
            },
            "346F": {
                        "benign": 0.8112,
                        "harmful": 0.1888,
                        "rank": 126,
                        "position": "346",
                        "amino_acid": "F",
                        "original": "K"
            },
            "346E": {
                        "benign": 0.7841,
                        "harmful": 0.2159,
                        "rank": 30,
                        "position": "346",
                        "amino_acid": "E",
                        "original": "K"
            },
            "346D": {
                        "benign": 0.7746,
                        "harmful": 0.2254,
                        "rank": 17,
                        "position": "346",
                        "amino_acid": "D",
                        "original": "K"
            },
            "346C": {
                        "benign": 0.8272,
                        "harmful": 0.1728,
                        "rank": 184,
                        "position": "346",
                        "amino_acid": "C",
                        "original": "K"
            },
            "401Y": {
                        "benign": 0.9112,
                        "harmful": 0.0888,
                        "rank": 291,
                        "position": "401",
                        "amino_acid": "Y",
                        "original": "K"
            },
            "346A": {
                        "benign": 0.8106,
                        "harmful": 0.1894,
                        "rank": 121,
                        "position": "346",
                        "amino_acid": "A",
                        "original": "K"
            },
            "401S": {
                        "benign": 0.9363,
                        "harmful": 0.0637,
                        "rank": 327,
                        "position": "401",
                        "amino_acid": "S",
                        "original": "K"
            },
            "401R": {
                        "benign": 0.9099,
                        "harmful": 0.0901,
                        "rank": 290,
                        "position": "401",
                        "amino_acid": "R",
                        "original": "K"
            },
            "401Q": {
                        "benign": 0.8848,
                        "harmful": 0.1152,
                        "rank": 267,
                        "position": "401",
                        "amino_acid": "Q",
                        "original": "K"
            },
            "401P": {
                        "benign": 0.9001,
                        "harmful": 0.0999,
                        "rank": 285,
                        "position": "401",
                        "amino_acid": "P",
                        "original": "K"
            },
            "401W": {
                        "benign": 0.9238,
                        "harmful": 0.0762,
                        "rank": 306,
                        "position": "401",
                        "amino_acid": "W",
                        "original": "K"
            },
            "401T": {
                        "benign": 0.9212,
                        "harmful": 0.0788,
                        "rank": 303,
                        "position": "401",
                        "amino_acid": "T",
                        "original": "K"
            },
            "401K": {
                        "benign": 0.928,
                        "harmful": 0.072,
                        "rank": 309,
                        "position": "401",
                        "amino_acid": "K",
                        "original": "K"
            },
            "401I": {
                        "benign": 0.8897,
                        "harmful": 0.1103,
                        "rank": 274,
                        "position": "401",
                        "amino_acid": "I",
                        "original": "K"
            },
            "401H": {
                        "benign": 0.9361,
                        "harmful": 0.0639,
                        "rank": 325,
                        "position": "401",
                        "amino_acid": "H",
                        "original": "K"
            },
            "401N": {
                        "benign": 0.9364,
                        "harmful": 0.0636,
                        "rank": 331,
                        "position": "401",
                        "amino_acid": "N",
                        "original": "K"
            },
            "401M": {
                        "benign": 0.8535,
                        "harmful": 0.1465,
                        "rank": 235,
                        "position": "401",
                        "amino_acid": "M",
                        "original": "K"
            },
            "401L": {
                        "benign": 0.8707,
                        "harmful": 0.1293,
                        "rank": 243,
                        "position": "401",
                        "amino_acid": "L",
                        "original": "K"
            },
            "401C": {
                        "benign": 0.8594,
                        "harmful": 0.1406,
                        "rank": 237,
                        "position": "401",
                        "amino_acid": "C",
                        "original": "K"
            },
            "401A": {
                        "benign": 0.9339,
                        "harmful": 0.0661,
                        "rank": 321,
                        "position": "401",
                        "amino_acid": "A",
                        "original": "K"
            },
            "401G": {
                        "benign": 0.8887,
                        "harmful": 0.1113,
                        "rank": 272,
                        "position": "401",
                        "amino_acid": "G",
                        "original": "K"
            },
            "401F": {
                        "benign": 0.8735,
                        "harmful": 0.1265,
                        "rank": 246,
                        "position": "401",
                        "amino_acid": "F",
                        "original": "K"
            },
            "401E": {
                        "benign": 0.9335,
                        "harmful": 0.0665,
                        "rank": 320,
                        "position": "401",
                        "amino_acid": "E",
                        "original": "K"
            },
            "401D": {
                        "benign": 0.8842,
                        "harmful": 0.1158,
                        "rank": 265,
                        "position": "401",
                        "amino_acid": "D",
                        "original": "K"
            },
            "305N": {
                        "benign": 0.8164,
                        "harmful": 0.1836,
                        "rank": 146,
                        "position": "305",
                        "amino_acid": "N",
                        "original": "K"
            },
            "305L": {
                        "benign": 0.7935,
                        "harmful": 0.2065,
                        "rank": 51,
                        "position": "305",
                        "amino_acid": "L",
                        "original": "K"
            },
            "305M": {
                        "benign": 0.7937,
                        "harmful": 0.2063,
                        "rank": 52,
                        "position": "305",
                        "amino_acid": "M",
                        "original": "K"
            },
            "305K": {
                        "benign": 0.8042,
                        "harmful": 0.1958,
                        "rank": 89,
                        "position": "305",
                        "amino_acid": "K",
                        "original": "K"
            },
            "305H": {
                        "benign": 0.803,
                        "harmful": 0.197,
                        "rank": 87,
                        "position": "305",
                        "amino_acid": "H",
                        "original": "K"
            },
            "305I": {
                        "benign": 0.8,
                        "harmful": 0.2,
                        "rank": 77,
                        "position": "305",
                        "amino_acid": "I",
                        "original": "K"
            },
            "305G": {
                        "benign": 0.8223,
                        "harmful": 0.1777,
                        "rank": 165,
                        "position": "305",
                        "amino_acid": "G",
                        "original": "K"
            },
            "305D": {
                        "benign": 0.8461,
                        "harmful": 0.1539,
                        "rank": 231,
                        "position": "305",
                        "amino_acid": "D",
                        "original": "K"
            },
            "305E": {
                        "benign": 0.8072,
                        "harmful": 0.1928,
                        "rank": 102,
                        "position": "305",
                        "amino_acid": "E",
                        "original": "K"
            },
            "305C": {
                        "benign": 0.8109,
                        "harmful": 0.1891,
                        "rank": 122,
                        "position": "305",
                        "amino_acid": "C",
                        "original": "K"
            },
            "305A": {
                        "benign": 0.7874,
                        "harmful": 0.2126,
                        "rank": 37,
                        "position": "305",
                        "amino_acid": "A",
                        "original": "K"
            },
            "305Y": {
                        "benign": 0.8101,
                        "harmful": 0.1899,
                        "rank": 117,
                        "position": "305",
                        "amino_acid": "Y",
                        "original": "K"
            },
            "305V": {
                        "benign": 0.8112,
                        "harmful": 0.1888,
                        "rank": 127,
                        "position": "305",
                        "amino_acid": "V",
                        "original": "K"
            },
            "305W": {
                        "benign": 0.7833,
                        "harmful": 0.2167,
                        "rank": 28,
                        "position": "305",
                        "amino_acid": "W",
                        "original": "K"
            },
            "305T": {
                        "benign": 0.8232,
                        "harmful": 0.1768,
                        "rank": 167,
                        "position": "305",
                        "amino_acid": "T",
                        "original": "K"
            },
            "305R": {
                        "benign": 0.8,
                        "harmful": 0.2,
                        "rank": 78,
                        "position": "305",
                        "amino_acid": "R",
                        "original": "K"
            },
            "305S": {
                        "benign": 0.7859,
                        "harmful": 0.2141,
                        "rank": 36,
                        "position": "305",
                        "amino_acid": "S",
                        "original": "K"
            },
            "305P": {
                        "benign": 0.7468,
                        "harmful": 0.2532,
                        "rank": 2,
                        "position": "305",
                        "amino_acid": "P",
                        "original": "K"
            },
            "305Q": {
                        "benign": 0.8028,
                        "harmful": 0.1972,
                        "rank": 86,
                        "position": "305",
                        "amino_acid": "Q",
                        "original": "K"
            },
            "306C": {
                        "benign": 0.7968,
                        "harmful": 0.2032,
                        "rank": 66,
                        "position": "306",
                        "amino_acid": "C",
                        "original": "K"
            },
            "306A": {
                        "benign": 0.747,
                        "harmful": 0.253,
                        "rank": 3,
                        "position": "306",
                        "amino_acid": "A",
                        "original": "K"
            },
            "306G": {
                        "benign": 0.7649,
                        "harmful": 0.2351,
                        "rank": 10,
                        "position": "306",
                        "amino_acid": "G",
                        "original": "K"
            },
            "306F": {
                        "benign": 0.8135,
                        "harmful": 0.1865,
                        "rank": 136,
                        "position": "306",
                        "amino_acid": "F",
                        "original": "K"
            },
            "306E": {
                        "benign": 0.8141,
                        "harmful": 0.1859,
                        "rank": 137,
                        "position": "306",
                        "amino_acid": "E",
                        "original": "K"
            },
            "306D": {
                        "benign": 0.8433,
                        "harmful": 0.1567,
                        "rank": 229,
                        "position": "306",
                        "amino_acid": "D",
                        "original": "K"
            },
            "306K": {
                        "benign": 0.7751,
                        "harmful": 0.2249,
                        "rank": 18,
                        "position": "306",
                        "amino_acid": "K",
                        "original": "K"
            },
            "306I": {
                        "benign": 0.7593,
                        "harmful": 0.2407,
                        "rank": 8,
                        "position": "306",
                        "amino_acid": "I",
                        "original": "K"
            },
            "306H": {
                        "benign": 0.8175,
                        "harmful": 0.1825,
                        "rank": 153,
                        "position": "306",
                        "amino_acid": "H",
                        "original": "K"
            },
            "306N": {
                        "benign": 0.779,
                        "harmful": 0.221,
                        "rank": 24,
                        "position": "306",
                        "amino_acid": "N",
                        "original": "K"
            },
            "306M": {
                        "benign": 0.778,
                        "harmful": 0.222,
                        "rank": 21,
                        "position": "306",
                        "amino_acid": "M",
                        "original": "K"
            },
            "306L": {
                        "benign": 0.8345,
                        "harmful": 0.1655,
                        "rank": 211,
                        "position": "306",
                        "amino_acid": "L",
                        "original": "K"
            },
            "306S": {
                        "benign": 0.8005,
                        "harmful": 0.1995,
                        "rank": 81,
                        "position": "306",
                        "amino_acid": "S",
                        "original": "K"
            },
            "306R": {
                        "benign": 0.7702,
                        "harmful": 0.2298,
                        "rank": 12,
                        "position": "306",
                        "amino_acid": "R",
                        "original": "K"
            },
            "306Q": {
                        "benign": 0.8303,
                        "harmful": 0.1697,
                        "rank": 200,
                        "position": "306",
                        "amino_acid": "Q",
                        "original": "K"
            },
            "306P": {
                        "benign": 0.8433,
                        "harmful": 0.1567,
                        "rank": 228,
                        "position": "306",
                        "amino_acid": "P",
                        "original": "K"
            },
            "306W": {
                        "benign": 0.8237,
                        "harmful": 0.1763,
                        "rank": 171,
                        "position": "306",
                        "amino_acid": "W",
                        "original": "K"
            },
            "306V": {
                        "benign": 0.7693,
                        "harmful": 0.2307,
                        "rank": 11,
                        "position": "306",
                        "amino_acid": "V",
                        "original": "K"
            },
            "306T": {
                        "benign": 0.7577,
                        "harmful": 0.2423,
                        "rank": 6,
                        "position": "306",
                        "amino_acid": "T",
                        "original": "K"
            }
};;

        let selectedAminoAcid = null;

        // 氨基酸选择功能
        document.querySelectorAll('.amino-acid').forEach(aa => {
            aa.addEventListener('click', function() {
                document.querySelectorAll('.amino-acid').forEach(a => a.classList.remove('selected'));
                this.classList.add('selected');
                selectedAminoAcid = this.dataset.aa;
            });
        });

        function selectPosition(position) {
            document.getElementById('position').value = position;
        }

        function predictMutation() {
            const position = document.getElementById('position').value;
            
            if (!position || !selectedAminoAcid) {
                alert('⚠️ 请输入突变位置并选择目标氨基酸！');
                return;
            }

            const mutationId = position + selectedAminoAcid;
            const data = mutationData[mutationId];

            if (!data) {
                alert('❌ 抱歉，数据库中没有找到该突变的预测结果！\n\n可用位置: 302, 305, 306, 309, 346, 348, 384, 401, 417');
                return;
            }

            // 显示结果
            const resultsCard = document.getElementById('results');
            resultsCard.classList.add('show');
            
            // 更新基本信息
            document.getElementById('mutation-id').textContent = mutationId;
            document.getElementById('original-aa').textContent = `${data.original} (${getAminoAcidName(data.original)})`;
            document.getElementById('target-aa').textContent = `${selectedAminoAcid} (${getAminoAcidName(selectedAminoAcid)})`;
            document.getElementById('mutation-position').textContent = position;
            document.getElementById('rank').textContent = data.rank;

                         // 更新TCOY结合强度（添加动画效果）
             const bindingPercent = Math.round(data.harmful * 100);

             setTimeout(() => {
                 const benignBar = document.getElementById('benign-bar');

                 benignBar.style.width = bindingPercent + '%';
                 benignBar.textContent = bindingPercent + '%';
             }, 100);

                         // TCOY结合强度评估
             let riskText = '';
             
             if (data.harmful > 0.2) {
                 riskText = '🟢 高结合强度：该突变预测具有很强的TCOY结合能力，结合强度优异。';
             } else if (data.harmful > 0.1) {
                 riskText = '🟡 中等结合强度：该突变预测具有中等的TCOY结合能力，结合强度良好。';
             } else {
                 riskText = '🔴 低结合强度：该突变预测的TCOY结合能力较弱，建议进一步验证。';
             }

             document.getElementById('risk-text').textContent = riskText;

            // 计算百分位
            const percentile = Math.round((1 - (data.rank - 1) / 171) * 100);
            document.getElementById('percentile').textContent = percentile + '%';

            // 滚动到结果
            resultsCard.scrollIntoView({behavior: 'smooth'});
        }

        function getAminoAcidName(letter) {
            const names = {
                'A': '丙氨酸', 'R': '精氨酸', 'N': '天冬酰胺', 'D': '天冬氨酸',
                'C': '半胱氨酸', 'Q': '谷氨酰胺', 'E': '谷氨酸', 'G': '甘氨酸',
                'H': '组氨酸', 'I': '异亮氨酸', 'L': '亮氨酸', 'K': '赖氨酸',
                'M': '蛋氨酸', 'F': '苯丙氨酸', 'P': '脯氨酸', 'S': '丝氨酸',
                'T': '苏氨酸', 'W': '色氨酸', 'Y': '酪氨酸', 'V': '缬氨酸'
            };
            return names[letter] || letter;
        }

        // 回车键预测
        document.getElementById('position').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                predictMutation();
            }
        });

        // 输入验证
        document.getElementById('position').addEventListener('input', function() {
            const value = parseInt(this.value);
            if (value && (value < 302 || value > 417)) {
                this.style.borderColor = '#ff6b6b';
            } else {
                this.style.borderColor = '#4facfe';
            }
        });

        // 热图统计数据 - 直接从CSV数据生成
        const heatmapData = {
            positions: [302, 305, 306, 309, 346, 348, 384, 401, 417],
            amino_acids: ['A', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'Y'],
            // 每个位点的Top5氨基酸 (按TCOY结合强度排序)
            top5_data: {
                302: [
                    {aa: 'Y', value: 22.8, rank: 14},
                    {aa: 'V', value: 22.4, rank: 19},
                    {aa: 'F', value: 21.4, rank: 35},
                    {aa: 'G', value: 20.7, rank: 48},
                    {aa: 'P', value: 19.7, rank: 85}
                ],
                305: [
                    {aa: 'P', value: 25.3, rank: 2},
                    {aa: 'W', value: 21.7, rank: 28},
                    {aa: 'S', value: 21.4, rank: 36},
                    {aa: 'A', value: 21.3, rank: 37},
                    {aa: 'L', value: 20.7, rank: 51}
                ],
                306: [
                    {aa: 'A', value: 25.3, rank: 3},
                    {aa: 'T', value: 24.2, rank: 6},
                    {aa: 'I', value: 24.1, rank: 8},
                    {aa: 'G', value: 23.5, rank: 10},
                    {aa: 'V', value: 23.1, rank: 11}
                ],
                309: [
                    {aa: 'W', value: 24.8, rank: 5},
                    {aa: 'V', value: 22.6, rank: 15},
                    {aa: 'C', value: 21.9, rank: 26},
                    {aa: 'T', value: 21.6, rank: 32},
                    {aa: 'R', value: 21.1, rank: 40}
                ],
                346: [
                    {aa: 'K', value: 23.8, rank: 9},
                    {aa: 'W', value: 22.5, rank: 16},
                    {aa: 'D', value: 22.5, rank: 17},
                    {aa: 'E', value: 21.6, rank: 30},
                    {aa: 'R', value: 21.5, rank: 34}
                ],
                348: [
                    {aa: 'K', value: 24.8, rank: 4},
                    {aa: 'C', value: 23.0, rank: 13},
                    {aa: 'S', value: 22.1, rank: 23},
                    {aa: 'E', value: 21.6, rank: 31},
                    {aa: 'A', value: 21.5, rank: 33}
                ],
                384: [
                    {aa: 'H', value: 12.2, rank: 253},
                    {aa: 'W', value: 12.0, rank: 259},
                    {aa: 'E', value: 10.4, rank: 279},
                    {aa: 'P', value: 10.1, rank: 284},
                    {aa: 'L', value: 9.2, rank: 287}
                ],
                401: [
                    {aa: 'M', value: 14.7, rank: 235},
                    {aa: 'C', value: 14.1, rank: 237},
                    {aa: 'L', value: 12.9, rank: 243},
                    {aa: 'F', value: 12.6, rank: 246},
                    {aa: 'D', value: 11.6, rank: 265}
                ],
                417: [
                    {aa: 'S', value: 22.1, rank: 22},
                    {aa: 'A', value: 19.5, rank: 94},
                    {aa: 'C', value: 17.6, rank: 172},
                    {aa: 'T', value: 15.7, rank: 227},
                    {aa: 'M', value: 13.8, rank: 238}
                ]
            }
        };

        function showHeatmap() {
            const container = document.getElementById('heatmap-container');
            const tableContainer = document.getElementById('heatmap-table');
            
            // 切换显示状态
            if (container.style.display === 'none' || container.style.display === '') {
                container.style.display = 'block';
                generateHeatmapTable();
                container.scrollIntoView({behavior: 'smooth'});
            } else {
                container.style.display = 'none';
            }
        }

        function generateHeatmapTable() {
            const tableContainer = document.getElementById('heatmap-table');
            const positions = heatmapData.positions;
            const aminoAcids = heatmapData.amino_acids;
            
            // 指定需要标蓝色的突变
            const blueMutations = ['302Y', '302V', '306A', '306T', '306I', '309W', '309V', '346K', '346W', '346D', '348K', '348C'];
            
            let tableHTML = '';
            
            // 创建表头
            tableHTML += '<div class="heatmap-row">';
            tableHTML += '<div class="heatmap-cell header">氨基酸</div>';
            positions.forEach(pos => {
                tableHTML += `<div class="heatmap-cell header">${pos}</div>`;
            });
            tableHTML += '</div>';
            
            // 创建每一行氨基酸
            aminoAcids.forEach(aa => {
                tableHTML += '<div class="heatmap-row">';
                tableHTML += `<div class="heatmap-cell row-header">${aa}</div>`;
                
                positions.forEach(pos => {
                    const mutationId = pos + aa;
                    const isBlue = blueMutations.includes(mutationId);
                    const top5Data = heatmapData.top5_data[pos];
                    const aaData = top5Data.find(item => item.aa === aa);
                    
                    if (aaData) {
                        // 这是Top5氨基酸，检查是否需要标蓝色
                        const cellClass = isBlue ? 'top5 blue-highlight' : 'top5';
                        tableHTML += `
                            <div class="heatmap-cell ${cellClass}" title="排名: #${aaData.rank}&#10;TCOY结合强度: ${aaData.value}%">
                                <div class="value-display">
                                    <div class="aa-letter">${aa}</div>
                                    <div class="binding-value">${aaData.value}%</div>
                                </div>
                            </div>
                        `;
                    } else {
                        // 从mutationData中查找该位置和氨基酸的数据
                        const mutationInfo = mutationData[mutationId];
                        
                        if (mutationInfo) {
                            const bindingStrength = Math.round(mutationInfo.harmful * 100 * 10) / 10;
                            const cellClass = isBlue ? 'blue-highlight' : '';
                            tableHTML += `
                                <div class="heatmap-cell ${cellClass}" title="排名: #${mutationInfo.rank}&#10;TCOY结合强度: ${bindingStrength}%">
                                    <div class="value-display">
                                        <div class="aa-letter">${aa}</div>
                                        <div class="binding-value">${bindingStrength}%</div>
                                    </div>
                                </div>
                            `;
                        } else {
                            // 没有数据的位置
                            tableHTML += '<div class="heatmap-cell empty">-</div>';
                        }
                    }
                });
                
                tableHTML += '</div>';
            });
            
            tableContainer.innerHTML = tableHTML;
        }

        // ===== 上传功能相关代码 =====
        let uploadedFile = null;

        // 文件上传事件监听
        document.getElementById('fileInput').addEventListener('change', handleFileSelect);
        document.getElementById('runModelBtn').addEventListener('click', runModel);

        // 拖拽上传功能
        const uploadArea = document.querySelector('.upload-area');
        
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                handleFile(file);
            }
        }

        function handleFile(file) {
            // 重置错误信息
            hideError();
            
            // 检查文件类型
            if (!file.name.endsWith('.xlsx') && !file.name.endsWith('.xls')) {
                showError('❌ 请上传Excel文件（.xlsx 或 .xls 格式）');
                return;
            }

            // 简单检查文件名是否包含关键词（放宽限制）
            const fileName = file.name.toLowerCase();
            if (!fileName.includes('pylrs') && !fileName.includes('训练') && !fileName.includes('数据')) {
                showError('❌ 请上传正确的训练数据文件');
                return;
            }

            // 检查文件大小（放宽到0.5-10MB）
            const fileSizeMB = file.size / (1024 * 1024);
            if (fileSizeMB < 0.5 || fileSizeMB > 10) {
                showError('❌ 文件大小异常，请确认是否为正确的数据文件');
                return;
            }

            // 文件通过基本验证
            uploadedFile = file;
            showFileInfo(file);
            enableRunButton();
        }

        function showFileInfo(file) {
            const fileInfo = document.getElementById('fileInfo');
            const fileName = document.getElementById('fileName');
            const fileDetails = document.getElementById('fileDetails');
            
            fileName.textContent = `✅ ${file.name}`;
            fileDetails.innerHTML = `
                <div>文件大小: ${(file.size / (1024 * 1024)).toFixed(2)} MB</div>
                <div>上传时间: ${new Date().toLocaleString()}</div>
                <div>状态: 文件验证通过，可以运行模型</div>
            `;
            
            fileInfo.classList.add('show');
        }

        function showError(message) {
            const errorMessage = document.getElementById('errorMessage');
            const errorText = document.getElementById('errorText');
            
            errorText.textContent = message;
            errorMessage.classList.add('show');
            
            // 隐藏文件信息和禁用按钮
            document.getElementById('fileInfo').classList.remove('show');
            disableRunButton();
        }

        function hideError() {
            document.getElementById('errorMessage').classList.remove('show');
        }

        function enableRunButton() {
            const runBtn = document.getElementById('runModelBtn');
            runBtn.classList.add('active');
        }

        function disableRunButton() {
            const runBtn = document.getElementById('runModelBtn');
            runBtn.classList.remove('active');
        }

        function runModel() {
            if (!uploadedFile) {
                showError('❌ 请先上传数据文件！');
                return;
            }

            // 显示加载动画
            const loadingSpinner = document.getElementById('loadingSpinner');
            loadingSpinner.style.display = 'block';
            
            // 禁用按钮
            const runBtn = document.getElementById('runModelBtn');
            runBtn.style.opacity = '0.5';
            runBtn.style.pointerEvents = 'none';

            // 模拟模型运行过程
            setTimeout(() => {
                // 隐藏上传界面
                document.getElementById('upload-interface').style.display = 'none';
                
                // 显示预测界面
                document.getElementById('prediction-interface').style.display = 'block';
                
                // 隐藏加载动画
                loadingSpinner.style.display = 'none';
                
                // 滚动到顶部
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // 显示成功提示
                setTimeout(() => {
                    alert('🎉 模型运行成功！现在可以进行蛋白质突变预测了。');
                }, 500);
                
            }, 3000); // 3秒后显示预测界面
        }

                 // 页面加载时的初始化
         document.addEventListener('DOMContentLoaded', function() {
             // 确保上传界面显示，预测界面隐藏
             document.getElementById('upload-interface').style.display = 'block';
             document.getElementById('prediction-interface').style.display = 'none';
         });
    </script>
</body>
</html>